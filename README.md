# AWSK(航空戦シミュレーター)
Air War Simulator for Kantai Collection

## 概要

- [艦これ](http://www.dmm.com/netgame/feature/kancolle.html)において、航空戦の結果をシミュレーションするソフトウェアです
- 現在実装が完了している機能は次の部分だけです(それでも役立つとは思いますが)
 - 基地航空隊によって削った後の敵制空値を下側確率と確率分布で表示
 - それぞれの基地航空隊における制空状況(航空優勢・航空劣勢など)の割合表示
- 高速で計算を行える他、艦娘・装備データをオンラインからダウンロードして更新も可能です
 - ただし、ダウンロード後はソフトウェアを再起動してください
- sampleフォルダに、基地航空隊編成や敵艦隊編成のサンプルデータが置いてあります(読み込み方は後述)

## 画面構成・使い方

　**まずAWSK.exeをクリックして起動してみてください。**

![image](https://user-images.githubusercontent.com/3734392/36708155-0c4bc58c-1bb5-11e8-8218-70bb35612733.png)

- 基地航空隊において、各航空隊の攻撃回数のコンボボックスを右クリックすると、基地航空隊設定の保存・読み込みができます
- 敵艦隊において、一番上のコンボボックスを右クリックすると、装備の詳細表示、および敵艦隊設定の保存・読み込みができます
- 「計算結果」画面のグラフを右クリックすると、グラフ画像や詳細なテキストデータをクリップボードにコピーできます

![image](https://user-images.githubusercontent.com/3734392/35803422-1dcae388-0ab7-11e8-9be6-d0485eedef2f.png)

- KammusuPatch.csvは、『「データベースを更新」ボタンでも引っ張れないような艦』を追加するためのファイルです
 - 例えばイベントが始まったばかりだと、英Wikiなどのサイトにはまだ新艦のデータが上がってなかったりします
 - そこで、テキストファイルを編集することにより、まさに「パッチ」としてデータを補う機能がこれです
- KammusuPatch.csvはCSV(BOMなしUTF-8)形式で、見ての通りの入力フォーマットとなっています
 - 左から順に、ID・艦名・艦種・素の対空値・スロット数・スロットの搭載数・初期装備・艦娘フラグを入力します
 - 艦名と艦種は文字列で入力しますが、引用符で囲まないでください
 - 「スロットの搭載数」と「初期装備」はそれぞれ5スロット分ありますが **これは艦これの仕様です**
 - 艦娘フラグは、艦娘なら「1」、深海棲艦なら「0」を入力してください
 - IDの番号をどう付けたらいいかですが、 **お察しください**
 - 艦種の文字列は今のところ「駆逐艦」「軽巡洋艦」「重雷装巡洋艦」「練習巡洋艦」「重巡洋艦」「航空巡洋艦」「戦艦」「巡洋戦艦」「航空戦艦」「正規空母」「装甲空母」「軽空母」「水上機母艦」「潜水艦」「潜水空母」「海防艦」「潜水母艦」「揚陸艦」「工作艦」「補給艦」としています。なお、歴史的な事情により、 **PT小鬼群は「駆逐艦」、各種姫・鬼は概ね「航空戦艦」としています**
- KammusuPatch.csvに入力された内容は何よりも優先されます。「データベースを更新」ボタンを押すとまずオンラインの情報を拾い集めてデータベースを構築し、それからKammusuPatch.csvの内容が追加・上書きされます
 - この上書きはIDの番号をキーとしますので、例えばKammusuPatch.csvでIDが410、type(艦種)が"戦艦"であるデータを重ねますと、既にID410に"清霜"がいることから、ソフトの上でだけ **清霜は戦艦になれます**

![image](https://user-images.githubusercontent.com/3734392/36781797-5e4e3a08-1cba-11e8-9277-23b623cb3de5.png)

## 注意
- ソフトウェアの動作には、 **.NET Framework 4.6.2** 以上が必要です
- **WeaponData.csv** には、装備の戦闘行動半径の情報が書かれています
- **GameData.db** には、艦娘(深海棲艦)・装備の情報がSQLite3形式で書き込まれています
- **KammusuPatch.csv** には、前述のように追加の艦娘(深海棲艦)の情報がCSV形式で書き込まれています

## 作者
　YSR([Twitter](https://twitter.com/YSRKEN), [GitHub](https://github.com/YSRKEN/))

## 謝辞
- Readmeやヘルプファイルなどの表示に、[tatesuke](https://github.com/tatesuke) さんの「 [かんたんMarkdown](https://github.com/tatesuke/KanTanMarkdown) 」を使用しました
- ソフトウェア開発に協力してくださった、[pokopii](https://twitter.com/galpokopii)さんや[avaris](https://twitter.com/nc254cntct)さんや[mizucchi41](https://twitter.com/mizucchi41)さんに深く感謝いたします

## License
　MIT License

## 使用ライブラリ
- [Prism.Unity](https://www.nuget.org/packages/Prism.Unity/)
 - MVVMによるソフトウェア構築に使用
- [ReactiveProperty](https://www.nuget.org/packages/ReactiveProperty/4.0.0-pre4)
 - 同上
- [DynamicJson](https://archive.codeplex.com/?p=dynamicjson)
 - JSONファイルの読み込みに使用
- [System.Data.SQLite.Core](https://www.nuget.org/packages/System.Data.SQLite.Core/)
 - データベースの読み書きに使用
- [OxyPlot.Wpf](https://www.nuget.org/packages/OxyPlot.Wpf/)
 - グラフ表示に使用
- [MersenneTwister](https://github.com/akiotakahashi/MersenneTwister)
 - 乱数生成に使用

## 更新履歴

### Ver.1.4.4
- 計算速度が2倍速くなった
- KammusuPatch.csvに追加の艦娘/深海棲艦を記述するようにした
 - これにより、オンラインのデータベースに存在してない艦でも好きなだけ追加できるようになります

### Ver.1.4.3
- イベントのボスマス敵艦隊の編成をE2～E7までサンプルとして用意した
 - これに合わせて敵艦のデータも拡充した
- 敵制空値の分布をモンテカルロ法で割り出す際の手法を変更した
 - Ver.1.3.0から、残存機数の分布を制空値の分布に変換して畳み込んでいた
 - しかしそれだと **実際には起こりえない組み合わせのスロット配置** も勘案していたことが判明
 - ゆえに、St1撃墜した後の敵制空値をそのままカウントする方式にコードを差し戻した

### Ver.1.4.2
- イベントのボスマス敵艦隊の編成をE2～E4までサンプルとして用意した

### Ver.1.4.1
- データベースをダウンロードする際、より幅広い艦娘のデータを使えるようになった
- データベースの更新中は、更新ボタンとシミュレーションボタンを押せないようにした
- サンプルデータを増やした

### Ver.1.4.0
- 敵艦のデータを大幅に追加した。また、区別しやすいよう、敵艦にはIDを表示するようにした
- UIオブジェクトの幅を調節し、また小さすぎた時用にウィンドウをリサイズ可能とした
- 敵艦を、艦種から選択できるようにした(詳しくは「使い方」欄にて)
- 敵艦隊の詳細を表示する際、搭載数情報を表示するようにした

### Ver.1.3.0
- UI周りのソースコードを大幅にリファクタリング
- 小数を含む計算を、等価な整数演算に置き換えて高速化
- 乱数生成エンジンを、NET標準の雑な奴からメルセンヌ・ツイスタ(SFMT)に変更
- 敵制空値の分布について、下側確率だけでなく確率分布も表示するように
- 敵制空値の分布をモンテカルロ法で割り出す際の手法を変更した
 - 従来は、St1撃墜した後の敵制空値をそのままカウントしていた
 - 今後は、残存機数の分布をスロット毎にカウントしてから、それぞれを畳み込むように
 - これにより、シミュレーション結果の精度が大幅に向上することになった
- その他細かな計算の高速化

### Ver.1.2.0
- 基地航空隊における航空戦では、敵艦隊の水上偵察機も制空権争いに参加することを忘れていたので修正
- 敵艦の詳細(装備など)を表示できるようにした
- 基地航空隊および敵艦隊の情報を保存・読み込みする機能を追加

### Ver.1.1.0
- 局地戦闘機などの制空値が反映されていない不具合を修正
- 艦載機の改修効果を間違えていたので修正
- ウィンドウを最小化できるようにした
- ちょっとした表示ミスを修正

### Ver.1.0.0
- 初公開
